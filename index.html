<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<title>AllNighter</title>
	<link href="style.css" rel="stylesheet" type="text/css">
	<link rel="stylesheet" href="https://use.typekit.net/pbk1pdf.css">
	<link rel="icon" href="favicon.png" type="image/png">
</head>
<body>
	<div class="container">
		<div class="menu-container">
			<div class="menu-navbar">
				<img src="allnighter-logo.png" alt="allnighter" id="img-logo"/>
			</div>	
		</div>
		<h1>¡Bienvenidx a AllNighter!</h1>
		<h2>En Chrome pod&eacute;s testear hasta 10 archivos en simult&aacute;neo.</h2>
		<div class="form-upload">
			<form class="upload" >
				<input type="file"  class="btn" id="btn" multiple>	
			</form>
		</div>
	</div>
	<div id="outdiv">
	<div id="console">
	</div></div>
	
	<div class="footer">
		<p>Este sitio web ha sido construido por Juli&aacute;n Moreira y Juli&aacute;n Laurito.<br><a href="https://www.mercadopago.com.ar/checkout/v1/redirect?pref_id=238334881-9e931d32-3cf0-4d2e-ba21-4c6ef7244d29" class="footer-link">Invitanos una birra &hearts;</a></p>
	</div>
<script>
	var namef = ["", "", "","", "", "","", "", "",""];
	var a = 0;

	function StartOP(e) {
		a=0;
		var div = document.getElementById("console"); 

		while (div.firstChild) {
			div.removeChild(div.firstChild);
		}
			
		for(var i = 0; i<e.target.files.length;i++){
			namef[i] = e.target.files[i].name;
		}

		var tag;
		var text;
		var element;
			
		for(var i = 0; i < e.target.files.length;i++){
			var reader = new FileReader();

			reader.onloadend = function(e) {
				var contents = reader.result;
				displayContents(contents);
			};

			reader.readAsText(e.target.files[i]);
		}	
	}

	function checkForm( thetxt )
	{
		var withoutEnter = thetxt.replace(/\r?\n|\r/g, '');
		var result = withoutEnter.match(/[ÁÉÍÓÜÚáéí'óüúÑñ–—€®©℠™´’‘]/g);

		return result;
	}
		
	function displayContents(contents) {	
		var texto = contents;
		var tag;
		var text;
		var element;
		var name = namef[a];
		a++;

		if(checkForm(contents)){
			var result = "";
			var lines = [];
			lines = texto.split("\n");
			var element = document.getElementById('demo');

			for(var linea = 0;linea < lines.length;linea++){
				for(var puesto = 0;puesto < lines[linea].length;puesto++){
					if(lines[linea].charAt(puesto).match(/[ÁÉÍÓÜÚáéí'óüúÑñ–—€®©℠™´’‘]/g) !== null){
						result = "ARCHIVO: "+name+":    LINEA: "+ (linea+1).toString()+" - PUESTO: "+(puesto+1).toString()+'\n';
						tag = document.createElement("p");
						tag.className = "line-1 anim-typewriter";
						text = document.createTextNode(result);
						tag.appendChild(text);
						element = document.getElementById("console");
						element.appendChild(tag);
					}
				}
			}
		}else{
			tag = document.createElement("p");
			text = document.createTextNode("ARCHIVO: "+name+ " - NO CONTIENE CARACTERES ESPECIALES");
			tag.appendChild(text);
			element = document.getElementById("console");
			tag.className = "line-1 anim-typewriter";
			element.appendChild(tag);
		}		
	}

	document.getElementById('btn')
	.addEventListener('change', StartOP, false);
</script>

</body>
</html>
